# Time Logger - Astro + Supabase

A modern time tracking application built with Astro and Supabase, featuring a beautiful design inspired by Linear, Vercel, and other modern tech startups.

## Features

- ⏱️ **Time Tracking**: Start, pause, resume, and end work sessions
- ✅ **Task Management**: Log completed tasks with automatic duration tracking
- 📊 **Weekly Reports**: Visualize your work hours with interactive charts
- 📜 **Work History**: View all completed work sessions
- 🌗 **Dark/Light Mode**: Seamless theme switching
- 📱 **Responsive Design**: Works on all devices
- 🔐 **Authentication**: Secure auth powered by Supabase

## Tech Stack

- **Frontend**: Astro, TypeScript
- **Database**: Supabase (PostgreSQL)
- **Charts**: Chart.js
- **Styling**: Custom CSS with modern design tokens
- **Date Utilities**: date-fns

## Getting Started

### Prerequisites

- Node.js 18+ 
- npm or pnpm
- Supabase account

### Database Setup

Run this SQL in your Supabase SQL editor to create the required tables:

```sql
-- Tables
create table if not exists public.work_logs (
  id bigint generated by default as identity primary key,
  user_id uuid not null references auth.users(id) on delete cascade,
  start_time timestamptz not null default now(),
  pause_time timestamptz,
  end_time timestamptz,
  total_seconds integer not null default 0,
  description text,
  created_at timestamptz not null default now()
);

create table if not exists public.tasks (
  id bigint generated by default as identity primary key,
  work_log_id bigint not null references public.work_logs(id) on delete cascade,
  user_id uuid not null references auth.users(id) on delete cascade,
  description text not null,
  duration integer not null default 0,
  created_at timestamptz not null default now()
);

-- Indexes
create index if not exists idx_work_logs_user on public.work_logs(user_id, start_time desc);
create index if not exists idx_tasks_worklog on public.tasks(work_log_id, created_at);

-- Enable RLS
alter table public.work_logs enable row level security;
alter table public.tasks enable row level security;

-- Policies
create policy "work_logs_select" on public.work_logs for select using (auth.uid() = user_id);
create policy "work_logs_modify" on public.work_logs for all using (auth.uid() = user_id) with check (auth.uid() = user_id);

create policy "tasks_select" on public.tasks for select using (auth.uid() = user_id);
create policy "tasks_modify" on public.tasks for all using (auth.uid() = user_id) with check (auth.uid() = user_id);
```

### Installation

1. Install dependencies:
```bash
npm install
```

2. Environment variables are already set in `.env`

3. Start the development server:
```bash
npm run dev
```

4. Open [http://localhost:4321](http://localhost:4321)

## Project Structure

```
/
├── src/
│   ├── layouts/
│   │   └── BaseLayout.astro    # Main layout with sidebar & theme toggle
│   ├── pages/
│   │   ├── index.astro         # Timer dashboard
│   │   ├── history.astro       # Work history
│   │   ├── weekly.astro        # Weekly report with charts
│   │   ├── login.astro         # Login page
│   │   ├── register.astro      # Registration page
│   │   └── api/                # API routes
│   │       ├── start.ts
│   │       ├── pause.ts
│   │       ├── resume.ts
│   │       ├── complete-task.ts
│   │       └── end-day.ts
│   ├── lib/
│   │   ├── supabase.ts         # Supabase client
│   │   └── database.types.ts   # Database types
│   └── styles/
│       ├── global.css          # Global styles & design system
│       └── auth.css            # Auth page styles
└── public/
```

## Usage

### Starting a Work Session

1. Click "Start Work" on the timer page
2. The timer begins tracking your time automatically

### Tracking Tasks

1. While working, enter task descriptions in the input field
2. Click "Complete Task" to log a task with its duration
3. Tasks are automatically timestamped and saved

### Managing Your Session

- **Pause**: Stop the timer without ending your session
- **Resume**: Continue from where you paused
- **End Day**: Complete your work session and save all data

### Viewing Reports

- **History**: See all completed work sessions with task breakdowns
- **Weekly Report**: View daily hours, earnings estimate, and visual charts

## Customization

### Changing the Hourly Rate

Edit the `hourlyRate` variable in `src/pages/weekly.astro`:

```typescript
const hourlyRate = 10; // Change this value
```

### Theme Colors

Modify CSS variables in `src/styles/global.css`:

```css
:root {
  --color-accent: #3b82f6;
  --color-success: #22c55e;
  /* ... more colors */
}
```

## Deployment

Build the production site:

```bash
npm run build
```

Preview the build:

```bash
npm run preview
```

Deploy to your favorite hosting platform (Vercel, Netlify, etc.).

## License

MIT
